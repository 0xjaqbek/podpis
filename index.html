<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;">
    <title>Historia Medyczna i Formularz Zgody</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <img id="logoImage" src="hb-removebg-preview.png" style="display: none;" />
    <div class="form-container">
        <h1>Historia Medyczna i Formularz Zgody</h1>
        
        <form id="medicalForm">
            <div class="form-group">
                <label for="name">Imię i Nazwisko:</label>
                <input type="text" id="name" required>
            </div>

            <div class="form-group">
                <label for="pesel">PESEL:</label>
                <input type="text" id="pesel" maxlength="11" required 
                       pattern="[0-9]{11}" title="PESEL musi zawierać 11 cyfr">
            </div>

            <div class="form-group">
                <label for="dob">Data urodzenia:</label>
                <input type="date" id="dob" required>
            </div>

            <div class="form-group">
                <label for="address">Adres zamieszkania:</label>
                <input type="text" id="address" required>
            </div>

            <div class="form-group">
                <label>Czy występują choroby przewlekłe?</label>
                <div class="radio-group">
                    <label>
                        <input type="radio" id="conditions-yes" name="conditions" value="tak">
                        Tak
                    </label>
                    <label>
                        <input type="radio" id="conditions-no" name="conditions" value="nie">
                        Nie
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="conditions-description">Jeśli tak, proszę wymienić:</label>
                <textarea id="conditions-description" rows="3"></textarea>
            </div>

            <div class="form-group">
                <label for="medications">Przyjmowane leki:</label>
                <textarea id="medications" rows="3"></textarea>
            </div>

            <div class="form-group">
                <label for="allergies">Alergie:</label>
                <textarea id="allergies" rows="3"></textarea>
            </div>

            <div class="consent-text">
                <h3>Zgoda na świadczenia medyczne</h3>
                <p>Ja, niżej podpisany(a), wyrażam zgodę na udzielanie świadczeń zdrowotnych. Potwierdzam, że zostałem(am) poinformowany(a) o moim stanie zdrowia, proponowanych metodach diagnostycznych i leczniczych oraz o możliwych powikłaniach i ryzyku. Oświadczam również, że podane przeze mnie informacje są zgodne z prawdą.</p>
            </div>

            <div class="rodo-section">
                <h3>Informacja o przetwarzaniu danych osobowych (RODO)</h3>
                <p>Zgodnie z art. 13 ust. 1 i 2 Rozporządzenia Parlamentu Europejskiego i Rady (UE) 2016/679 z dnia 27 kwietnia 2016 r. informujemy, że:</p>
                <ol>
                    <li>Administratorem Pani/Pana danych osobowych jest [Nazwa Placówki] z siedzibą przy [Adres].</li>
                    <li>Pani/Pana dane osobowe przetwarzane będą w celu świadczenia usług medycznych oraz prowadzenia dokumentacji medycznej.</li>
                    <li>Posiada Pani/Pan prawo dostępu do treści swoich danych oraz prawo ich sprostowania, usunięcia, ograniczenia przetwarzania, prawo do przenoszenia danych, prawo wniesienia sprzeciwu.</li>
                    <li>Pani/Pana dane będą przechowywane przez okres wynikający z przepisów prawa, w szczególności z ustawy o prawach pacjenta i Rzeczniku Praw Pacjenta.</li>
                    <li>Ma Pani/Pan prawo wniesienia skargi do UODO gdy uzna Pani/Pan, że przetwarzanie danych osobowych narusza przepisy RODO.</li>
                </ol>
            </div>

            <div class="signature-container">
                <label>Podpis pacjenta:</label>
                <canvas id="signaturePad"></canvas>
            </div>

            <div class="buttons">
                <button type="button" class="clear-btn" id="clearButton">Wyczyść podpis</button>
                <button type="submit" class="submit-btn">Generuj PDF</button>
            </div>
        </form>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/4.1.5/signature_pad.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="pdfGenerator.js"></script>
    <script src="formHandler.js"></script>
</body>
</html>
